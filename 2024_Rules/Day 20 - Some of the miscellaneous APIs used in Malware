rule misc_apis
{  
  meta:
    author = "Denice"
    description = "Some of the miscellaneous APIs used in Malware"
    reference = "https://book.hacktricks.xyz/reversing-and-exploiting/common-api-used-in-malware"

  strings:
    $misc1 = "GetAsyncKeyState" nocase
    $misc2 = "SetWindowsHookEx" nocase
    $misc3 = "GetForeGroundWindow" nocase
    $misc4 = "LoadLibrary" nocase
    $misc5 = "GetProcAddress" nocase
    $misc6 = "NtWriteVirtualMemory" nocase
    $misc7 = "InternetOpen" nocase

  condition:
    any of them
}
