rule stealth_apis
{  
  meta:
    author = "Denice"
    description = "Common Stealthy APIs used in malware"
    reference = "https://book.hacktricks.xyz/reversing-and-exploiting/common-api-used-in-malware"

  strings:
    $stealth1 = "VirtualAlloc" nocase
    $stealth2 = "VirtualProtect" nocase
    $stealth3 = "ReadProcessMemory" nocase
    $stealth4 = "WriteProcessMemoryA" nocase
    $stealth5 = "WriteProcessMemoryW" nocase
    $stealth6 = "NtWriteVirtualMemory" nocase
    $stealth7 = "CreateRemoteThread" nocase
    $stealth8 = "NtUnmapViewOfSection" nocase
    $stealth9 = "QueueUserAPC" nocase
    $stealth10 = "CreateProcessInternalA" nocase
    $stealth11 = "CreateProcessInternalW" nocase

  condition:
    any of them
}

