rule antianalysis_apis
{  
  meta:
    author = "Denice"
    description = "Common Anti-Analysis APIs used in malware"
    reference = "https://book.hacktricks.xyz/reversing-and-exploiting/common-api-used-in-malware"

  strings:
    $encrypt1 = "IsDebuggerPresent" nocase
    $encrypt2 = "GetSystemInfo" nocase
    $encrypt3 = "GlobalMemoryStatusEx" nocase
    $encrypt4 = "GetVersion" nocase
    $encrypt5 = "CreateToolhelp32Snapshot" nocase
    $encrypt6 = "CreateFileA" nocase
    $encrypt7 = "CreateFileW" nocase

  condition:
    any of them
}
