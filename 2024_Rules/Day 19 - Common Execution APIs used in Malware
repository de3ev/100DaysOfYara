rule execution_apis
{  
  meta:
    author = "Denice"
    description = "Common Execution APIs used in Malware"
    reference = "https://book.hacktricks.xyz/reversing-and-exploiting/common-api-used-in-malware"

  strings:
    $exec1 = "CreateProcessA" nocase
    $exec2 = "CreateProcessW" nocase
    $exec3 = "ShellExecute" nocase
    $exec4 = "WinExec" nocase
    $exec5 = "ResumeThread" nocase
    $exec6 = "NtWriteVirtualMemory" nocase
    $exec7 = "NtResumeThread" nocase

  condition:
    3 of ($exec*)
}
