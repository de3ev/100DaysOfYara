rule encryption_apis
{  
  meta: 
    author = "Denice"
    description = "Common Encryption APIs used by Malware"
    reference = "https://book.hacktricks.xyz/reversing-and-exploiting/common-api-used-in-malware"

  strings:
    $encrypt1 = "WinCrypt" nocase
    $encrypt2 = "CryptAcquireContext" nocase
    $encrypt3 = "CryptGenKey" nocase
    $encrypt4 = "CryptDeriveKey" nocase
    $encrypt5 = "CryptDecrypt" nocase
    $encrypt6 = "CryptReleaseContext" nocase

  condition:
    any of them
}
